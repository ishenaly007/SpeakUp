@import '../styles/global.scss';

// Local SCSS variables (if not in global.scss)
$border-radius-sm: 4px !default;
$border-radius-lg: 20px !default; // Will be overridden by 25px for input elements
$box-shadow-sm: 0 1px 3px rgba(0,0,0,0.1) !default;
$box-shadow-lg: 0 4px 12px rgba(0,0,0,0.15) !default;

.animatedBackground {
  background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
  background-size: 400% 400%;
  animation: gradientBG 15s ease infinite;
  min-height: calc(100vh - #{$header-height}); // Use SASS var for header height
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
}

@keyframes gradientBG {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.chatContainer {
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
  padding: 20px;
  display: flex;
  flex-direction: column;
  width: 100%;
  max-width: 900px;
  // Height calculation based on fixed header/footer values as SASS vars might not be accessible in calc reliably for vh units
  // $footer-height would need to be defined globally, assuming 60px for now.
  height: calc(100vh - #{$header-height} - 40px - 60px); // 70px header, 40px parent padding, 60px footer
  // overflow: hidden; // Removed, messagesArea handles scrolling
}

.instructions {
  text-align: center;
  padding: 15px;
  background-color: #e9ecef;
  border-radius: 8px;
  margin-bottom: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  h2 { 
    margin-top: 0; 
    font-size: 1.6rem;
    color: var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px; // Updated gap
    svg {
      margin-right: 0; // Gap handles spacing
    }
  }
  p {
    font-size: 1rem;
    color: var(--text-color);
    max-width: 600px;
    margin: 0.5rem auto 0;
  }
}

.loadingText, .noMessages {
  padding: 15px; // Unified padding
  margin-top: 20px; // Added margin-top
  text-align: center;
  font-size: 1.1rem;
}

.noMessages {
  color: #6c757d; // Updated color
}

.loadingText {
  color: var(--secondary-color); // Retained from original
}

.errorText {
  color: #dc3545;
  background-color: #FFD2D2;
  border: 1px solid #D8000C;
  border-radius: 4px; // Updated border-radius
  padding: 15px; // Unified padding
  text-align: center;
  margin: 1rem;
}

.messagesArea {
  flex-grow: 1;
  overflow-y: auto;
  padding: 10px;
  background-color: #fff;
  border-radius: 8px;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
  margin-bottom: 15px;
  display: flex; // Added to allow gap for messages if needed, or manage individual margins
  flex-direction: column; // Ensure messages stack vertically
  // gap: 0.75rem; // Replaced by message margin-bottom
}

.message {
  padding: 10px 15px;
  border-radius: 15px;
  margin-bottom: 12px; // Added margin
  max-width: 75%;
  word-wrap: break-word;
  box-shadow: $box-shadow-sm;
  line-height: 1.5;

  p {
    margin: 0;
  }

  &.user {
    background-color: var(--primary-color);
    color: #fff;
    align-self: flex-end;
    border-bottom-right-radius: 5px; // Updated radius
    margin-left: auto; // Ensure it stays to the right
  }

  &.ai {
    background-color: #e9ecef; // Updated background
    color: var(--text-color);
    align-self: flex-start;
    border-bottom-left-radius: 5px; // Updated radius
    // border: 1px solid $border-color; // Removed border for AI messages as per new diff
  }

  .timestamp {
    font-size: 0.75rem;
    display: block;
    margin-top: 0.3rem;
    opacity: 0.7;

    &.user { // This nesting was incorrect in original provided, fixing
      color: rgba(#fff, 0.8);
      text-align: right;
    }
    &.ai { // This nesting was incorrect in original provided, fixing
      color: var(--secondary-color);
      text-align: left;
    }
  }
}
// Corrected timestamp class to be outside .user and .ai specific blocks if they are general to .message
.message .timestamp.user { // More specific selector if needed
    color: rgba(#fff, 0.8);
    text-align: right;
}
.message .timestamp.ai { // More specific selector if needed
    color: var(--secondary-color);
    text-align: left;
}


.inputArea {
  display: flex;
  align-items: center;
  padding: 1rem; // Keep existing padding or adjust to 15px top
  padding-top: 15px; // Specific top padding
  border-top: 1px solid #ddd;
  background-color: var(--surface-color);

  input[type="text"] {
    flex-grow: 1;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 25px;
    margin-right: 10px;
    font-size: 1rem;
    background-color: var(--background-color);

    &:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
    }
  }

  button {
    padding: 10px 20px;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;

    svg {
        margin-right: 0.5rem;
    }

    &:hover:not(:disabled) {
      background-color: #0056b3;
    }

    &:disabled {
      background-color: #a0a0a0;
      color: var(--secondary-color); // Fallback for darken($secondary-color, 20%)
      opacity: 0.7; // Added from diff
      cursor: not-allowed;
    }
  }
}

// Media Queries - Review and adjust heights considering the new main height calculation
@media (max-width: 768px) {
  .animatedBackground {
    padding: 10px; // Reduce padding on smaller screens for the background
    min-height: calc(100vh - #{$header-height}); // Ensure it still respects header
  }
  .chatContainer {
    // Adjust height considering less padding on animatedBackground
    height: calc(100vh - #{$header-height} - 20px - 60px); // 20px for parent padding now
    padding: 15px; // Slightly less padding for the container itself
  }
   .instructions {
    padding: 1rem;
    h2 { font-size: 1.4rem; svg {font-size: 1.3rem;} }
    p { font-size: 0.9rem; }
  }
  .inputArea {
    padding: 0.75rem;
    input[type="text"] { padding: 0.6rem 0.8rem; font-size: 0.95rem;}
    button { padding: 0.6rem 1rem; font-size: 0.95rem; }
  }
}

@media (max-width: 600px) {
  .animatedBackground {
    padding: 0; // No padding on very small screens, chat container takes full width
    min-height: calc(100vh - #{$header-height}); // Use mobile header height if different
  }
  .chatContainer {
    height: calc(100vh - #{$header-height} - 0px - 60px); // No parent padding, mobile header, footer
    border-radius: 0;
    // border: none; // Already no border
    max-width: 100%;
    margin: 0;
    padding: 10px; // Minimal padding for content
  }

  .instructions {
    padding: 0.75rem;
    border-radius: 0;
    h2 { font-size: 1.3rem; svg {font-size: 1.2rem;}}
    p { font-size: 0.85rem; }
  }

  .messagesArea {
    padding: 0.5rem;
    gap: 0.5rem;
  }

  .message {
    padding: 0.5rem 0.9rem;
    max-width: 85%;
    font-size: 0.9rem;
    &.user { border-bottom-right-radius: $border-radius-sm; }
    &.ai { border-bottom-left-radius: $border-radius-sm; }
  }

  .inputArea {
    padding: 0.5rem;
    border-radius: 0;
    input[type="text"] {
      padding: 0.5rem 0.75rem;
      font-size: 0.9rem;
      margin-right: 0.5rem;
      border-radius: 25px; // Keep pill shape
    }
    button {
      padding: 0.5rem 0.75rem;
      font-size: 0.9rem;
      border-radius: 25px; // Keep pill shape
      svg { margin-right: 0.25rem; font-size: 0.8rem;}
    }
  }
}
