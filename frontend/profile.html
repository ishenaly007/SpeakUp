<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - SpeakUpEngBot</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<header>
    <div class="logo">
        <img src="https://img.alicdn.com/imgextra/i2/1797064093/O1CN01FTdSDT1g6e7p1HAv6_!!1797064093.png_.webp" alt="SpeakUpEngBot Logo">
    </div>
    <h1>SpeakUpEngBot</h1>
    <nav>
        <a href="index.html">Lessons</a>
        <a href="chat.html">Chat</a>
        <a href="profile.html">Profile</a>
    </nav>
</header>
<main class="container">
    <h2>Profile</h2>
    <div class="profile-container">
        <div class="profile-avatar">
            <img src="https://upload.wikimedia.org/wikipedia/commons/1/19/Audi_A7_Sportback_Genf_2018.jpg" alt="User Avatar">
        </div>
        <div class="profile-info">
            <h3 id="username">Loading...</h3>
            <div class="premium-badge">Premium</div>
            <p><strong>Joined:</strong> <span id="joined-date">Loading...</span></p>
        </div>
        <div class="progress-bar">
            <div class="progress" id="level-progress"></div>
        </div>
        <p><strong>Level:</strong> <span id="level">Loading...</span> | <strong>XP:</strong> <span id="xp">Loading...</span> | <strong>XP to Next Level:</strong> <span id="remaining-xp">Loading...</span></p>
        <div class="stats-grid">
            <div class="stat-card">
                <h4>Lessons Completed</h4>
                <p>42</p>
            </div>
            <div class="stat-card">
                <h4>Learning Time</h4>
                <p>18h 30m</p>
            </div>
            <div class="stat-card">
                <h4>Correct Answers</h4>
                <p>85%</p>
            </div>
            <div class="stat-card">
                <h4>Lesson Streak</h4>
                <p>7 days</p>
            </div>
        </div>
        <h3>Achievements</h3>
        <div class="achievements-list">
            <div class="achievement">
                <img src="https://tr.rbxcdn.com/180DAY-f48f685518435d8b844f132ab01afffc/420/420/Hat/Webp/noFilter" alt="Beginner">
                <p>Beginner</p>
            </div>
            <div class="achievement">
                <img src="https://img.freepik.com/free-vector/cute-cool-boy-dabbing-pose-cartoon-vector-icon-illustration-people-fashion-icon-concept-isolated_138676-5680.jpg?semt=ais_hybrid&w=740" alt="Hard Worker">
                <p>Hard Worker</p>
            </div>
            <div class="achievement">
                <img src="https://cdn.costumewall.com/wp-content/uploads/2024/09/el-macho-costume.jpg" alt="Star Student">
                <p>Star Student</p>
            </div>
        </div>
        <div class="profile-actions">
            <button onclick="alert('Settings not implemented')">Settings</button>
            <button onclick="logout()">Log Out</button>
        </div>
    </div>
</main>
<script src="js/main.js"></script>
<script>
    const userId = checkAuth();
    if (userId) {
        apiRequest(`users/${userId}/profile`)
            .then(data => {
                document.getElementById('username').textContent = data.username;
                document.getElementById('level').textContent = data.calculatedLevel;
                document.getElementById('xp').textContent = data.xp;
                document.getElementById('remaining-xp').textContent = data.remainingXp;
                document.getElementById('joined-date').textContent = new Date(data.createdAt).toLocaleDateString('ru-RU');
                const progressPercent = (data.xp / (data.xp + data.remainingXp)) * 100;
                document.getElementById('level-progress').style.width = `${progressPercent}%`;
            })
            .catch(error => {
                document.querySelector('.profile-container').innerHTML = `<p class="error">Error loading profile: ${error.message}</p>`;
            });
    }

    function logout() {
        localStorage.removeItem('userId');
        window.location.href = 'login.html';
    }
</script>
</body>
</html>